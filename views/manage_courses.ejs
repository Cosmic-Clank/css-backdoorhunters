<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Manage Courses</title>
    <style>
        :root {
            --bg: #0b0f14;
            --panel: #0f1420;
            --border: #1e2635;
            --text: #e9eef7;
            --muted: #93a0b4;
            --accent: #22d3ee;
        }

        * {
            box-sizing: border-box
        }

        body {
            margin: 0;
            background: var(--bg);
            color: var(--text);
            font-family: Inter, ui-sans-serif, system-ui, Segoe UI, Roboto, Helvetica, Arial
        }

        a {
            color: #cfe7ff;
            text-decoration: none
        }

        .top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 14px 18px;
            border-bottom: 1px solid var(--border)
        }

        .shell {
            display: grid;
            grid-template-columns: 260px 1fr;
            gap: 18px;
            max-width: 1200px;
            margin: 18px auto;
            padding: 0 18px
        }

        .side {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 12px;
            position: sticky;
            top: 10px;
            height: max-content
        }

        .btn {
            display: block;
            width: 100%;
            text-align: left;
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 10px 12px;
            background: #0d1320;
            color: var(--text);
            margin-bottom: 10px;
            cursor: pointer;
            transition: background .2s, border-color .2s, box-shadow .2s
        }

        .btn:hover:not(:disabled),
        .btn:focus-visible {
            background: #131a29;
            border-color: var(--accent)
        }

        .btn.active {
            border-color: var(--accent);
            background: #141c30;
            box-shadow: 0 0 0 4px rgba(34, 211, 238, .15)
        }

        .main {
            background: var(--panel);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 16px
        }

        .h2 {
            margin: 0 0 6px 0;
            font-weight: 800
        }

        .muted {
            color: var(--muted);
            font-size: 13px
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 13px;
            margin-top: 12px
        }

        th,
        td {
            padding: 10px;
            border-bottom: 1px solid var(--border);
            text-align: left
        }

        tr:hover td {
            background-color: rgba(255, 255, 255, .03)
        }

        .imgbox {
            width: 100%;
            max-width: 220px;
            border: 1px solid var(--border);
            border-radius: 10px;
            overflow: hidden;
            background: #0c1220
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin-top: 12px
        }

        .input,
        select,
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: #0b101b;
            color: var(--text)
        }

        textarea {
            resize: vertical
        }

        .primary {
            background: linear-gradient(90deg, #22d3ee, #7c3aed);
            border: none;
            padding: 10px 14px;
            border-radius: 10px;
            color: #fff;
            cursor: pointer
        }

        .warn {
            background: #331b1b;
            border: 1px solid #5a2a2a;
            color: #ffd3d3;
            padding: 10px 12px;
            border-radius: 10px;
            margin-bottom: 10px
        }

        .toast {
            margin-bottom: 10px;
            border-radius: 10px;
            padding: 10px 12px
        }

        .toast.ok {
            background: #102718;
            border: 1px solid #1f4d2f;
            color: #b5ffd1
        }

        .toast.err {
            background: #2a1b1b;
            border: 1px solid #5a2a2a;
            color: #ffd1d1
        }
    </style>
</head>

<body>
    <div class="top">
        <div>üõ†Ô∏è <b>Manage Courses</b></div>
        <div class="muted">Admin ‚Ä¢ local</div>
    </div>

    <div class="shell">
        <aside class="side">
            <a id="tab-all" class="btn" href="/manage/courses<%= envQS %>&tab=all">üìö All Courses</a>
            <a id="tab-delete" class="btn" href="/manage/courses<%= envQS %>&tab=delete">üóëÔ∏è Delete Course</a>
            <a id="tab-add" class="btn" href="/manage/courses<%= envQS %>&tab=add">‚ûï Add New</a>
            <a class="btn" href="/dashboard<%= envQS %>">‚Üê Back to dashboard</a>
        </aside>

        <main class="main">
            <% if (toast==='deleted' ) { %>
                <div class="toast ok">Course deleted.</div>
                <% } %>
                    <% if (toast==='notfound' ) { %>
                        <div class="toast err">Course not found.</div>
                        <% } %>
                            <% if (toast==='error' ) { %>
                                <div class="toast err">Could not delete course.</div>
                                <% } %>
                                    <% if (toast==='added' ) { %>
                                        <div class="toast ok">Course added.</div>
                                        <% } %>
                                            <% if (toast==='slugtaken' ) { %>
                                                <div class="toast err">Slug already exists.</div>
                                                <% } %>
                                                    <% if (toast==='invalid' ) { %>
                                                        <div class="toast err">Please fill all fields correctly.</div>
                                                        <% } %>
                                                            <% if (toast==='noimg' ) { %>
                                                                <div class="toast err">Please upload an image.</div>
                                                                <% } %>
                                                                    <% if (toast==='badimg' ) { %>
                                                                        <div class="toast err">Only PNG/JPG images are
                                                                            allowed.</div>
                                                                        <% } %>
                                                                            <% if (toast==='bigimg' ) { %>
                                                                                <div class="toast err">Image too large
                                                                                    (max 5MB).</div>
                                                                                <% } %>
                                                                                    <% if (toast==='uploaderr' ) { %>
                                                                                        <div class="toast err">Upload
                                                                                            failed. Try again.</div>
                                                                                        <% } %>
                                                                                            <% if (toast==='saveerr' ) {
                                                                                                %>
                                                                                                <div class="toast err">
                                                                                                    Could not save
                                                                                                    course.</div>
                                                                                                <% } %>

                                                                                                    <% if (tab==='all' )
                                                                                                        { %>
                                                                                                        <div class="h2">
                                                                                                            All Courses
                                                                                                        </div>
                                                                                                        <div
                                                                                                            class="muted">
                                                                                                            Current
                                                                                                            catalog.
                                                                                                        </div>
                                                                                                        <div
                                                                                                            style="overflow:auto">
                                                                                                            <table>
                                                                                                                <thead>
                                                                                                                    <tr>
                                                                                                                        <th>ID
                                                                                                                        </th>
                                                                                                                        <th>Image
                                                                                                                        </th>
                                                                                                                        <th>Title
                                                                                                                        </th>
                                                                                                                        <th>Level
                                                                                                                        </th>
                                                                                                                        <th>Slug
                                                                                                                        </th>
                                                                                                                    </tr>
                                                                                                                </thead>
                                                                                                                <tbody>
                                                                                                                    <% for
                                                                                                                        (const
                                                                                                                        c
                                                                                                                        of
                                                                                                                        courses)
                                                                                                                        {
                                                                                                                        %>
                                                                                                                        <tr>
                                                                                                                            <td>
                                                                                                                                <%= c.id
                                                                                                                                    %>
                                                                                                                            </td>
                                                                                                                            <td>
                                                                                                                                <div
                                                                                                                                    class="imgbox">
                                                                                                                                    <img src="<%= c.image_path %>"
                                                                                                                                        alt="<%= c.title %>"
                                                                                                                                        style="width:100%;height:100%;object-fit:cover;display:block">
                                                                                                                                </div>
                                                                                                                            </td>
                                                                                                                            <td>
                                                                                                                                <%= c.title
                                                                                                                                    %>
                                                                                                                            </td>
                                                                                                                            <td
                                                                                                                                style="text-transform:capitalize;">
                                                                                                                                <%= c.level
                                                                                                                                    %>
                                                                                                                            </td>
                                                                                                                            <td><code><%= c.slug %></code>
                                                                                                                            </td>
                                                                                                                        </tr>
                                                                                                                        <% }
                                                                                                                            %>
                                                                                                                </tbody>
                                                                                                            </table>
                                                                                                        </div>
                                                                                                        <% } %>

                                                                                                            <% if
                                                                                                                (tab==='delete'
                                                                                                                ) { %>
                                                                                                                <div
                                                                                                                    class="h2">
                                                                                                                    Delete
                                                                                                                    Course
                                                                                                                </div>
                                                                                                                <div
                                                                                                                    class="warn">
                                                                                                                    Danger:
                                                                                                                    This
                                                                                                                    permanently
                                                                                                                    removes
                                                                                                                    a
                                                                                                                    course
                                                                                                                    from
                                                                                                                    the
                                                                                                                    database.
                                                                                                                </div>

                                                                                                                <form
                                                                                                                    method="POST"
                                                                                                                    action="/manage/courses/delete<%= envQS %>">
                                                                                                                    <label
                                                                                                                        for="course_id"
                                                                                                                        class="muted">Select
                                                                                                                        a
                                                                                                                        course</label>
                                                                                                                    <select
                                                                                                                        name="course_id"
                                                                                                                        id="course_id"
                                                                                                                        required>
                                                                                                                        <option
                                                                                                                            value=""
                                                                                                                            disabled
                                                                                                                            selected>
                                                                                                                            Choose
                                                                                                                            a
                                                                                                                            course‚Ä¶
                                                                                                                        </option>
                                                                                                                        <% for
                                                                                                                            (const
                                                                                                                            c
                                                                                                                            of
                                                                                                                            courses)
                                                                                                                            {
                                                                                                                            %>
                                                                                                                            <option
                                                                                                                                value="<%= c.id %>">
                                                                                                                                [#
                                                                                                                                <%= c.id
                                                                                                                                    %>
                                                                                                                                    ]
                                                                                                                                    <%= c.title
                                                                                                                                        %>
                                                                                                                                        ‚Äî
                                                                                                                                        <%= c.slug
                                                                                                                                            %>
                                                                                                                            </option>
                                                                                                                            <% }
                                                                                                                                %>
                                                                                                                    </select>

                                                                                                                    <div
                                                                                                                        class="controls">
                                                                                                                        <button
                                                                                                                            type="submit"
                                                                                                                            class="primary">Delete</button>
                                                                                                                    </div>
                                                                                                                </form>
                                                                                                                <% } %>

                                                                                                                    <% if
                                                                                                                        (tab==='add'
                                                                                                                        )
                                                                                                                        {
                                                                                                                        %>
                                                                                                                        <div
                                                                                                                            class="h2">
                                                                                                                            Add
                                                                                                                            New
                                                                                                                            Course
                                                                                                                        </div>
                                                                                                                        <div
                                                                                                                            class="muted">
                                                                                                                            Upload
                                                                                                                            a
                                                                                                                            cover
                                                                                                                            image
                                                                                                                            and
                                                                                                                            fill
                                                                                                                            out
                                                                                                                            details.
                                                                                                                        </div>

                                                                                                                        <form
                                                                                                                            method="POST"
                                                                                                                            action="/manage/courses/add<%= envQS %>"
                                                                                                                            enctype="multipart/form-data"
                                                                                                                            style="margin-top:12px">
                                                                                                                            <label
                                                                                                                                class="muted"
                                                                                                                                for="title">Title</label>
                                                                                                                            <input
                                                                                                                                class="input"
                                                                                                                                type="text"
                                                                                                                                id="title"
                                                                                                                                name="title"
                                                                                                                                required
                                                                                                                                placeholder="e.g., SSRF Deep Dive" />

                                                                                                                            <div
                                                                                                                                style="display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:12px">
                                                                                                                                <div>
                                                                                                                                    <label
                                                                                                                                        class="muted"
                                                                                                                                        for="level">Level</label>
                                                                                                                                    <select
                                                                                                                                        class="input"
                                                                                                                                        id="level"
                                                                                                                                        name="level"
                                                                                                                                        required>
                                                                                                                                        <option
                                                                                                                                            value=""
                                                                                                                                            disabled
                                                                                                                                            selected>
                                                                                                                                            Select
                                                                                                                                            level‚Ä¶
                                                                                                                                        </option>
                                                                                                                                        <option
                                                                                                                                            value="beginner">
                                                                                                                                            Beginner
                                                                                                                                        </option>
                                                                                                                                        <option
                                                                                                                                            value="intermediate">
                                                                                                                                            Intermediate
                                                                                                                                        </option>
                                                                                                                                        <option
                                                                                                                                            value="advanced">
                                                                                                                                            Advanced
                                                                                                                                        </option>
                                                                                                                                    </select>
                                                                                                                                </div>
                                                                                                                                <div>
                                                                                                                                    <label
                                                                                                                                        class="muted"
                                                                                                                                        for="slug">Slug
                                                                                                                                        (optional)</label>
                                                                                                                                    <input
                                                                                                                                        class="input"
                                                                                                                                        type="text"
                                                                                                                                        id="slug"
                                                                                                                                        name="slug"
                                                                                                                                        placeholder="auto-generated from title if empty" />
                                                                                                                                </div>
                                                                                                                            </div>

                                                                                                                            <label
                                                                                                                                class="muted"
                                                                                                                                for="summary"
                                                                                                                                style="margin-top:12px">Summary</label>
                                                                                                                            <textarea
                                                                                                                                class="input"
                                                                                                                                id="summary"
                                                                                                                                name="summary"
                                                                                                                                rows="4"
                                                                                                                                required
                                                                                                                                placeholder="One-paragraph summary of the course"></textarea>

                                                                                                                            <label
                                                                                                                                class="muted"
                                                                                                                                for="image"
                                                                                                                                style="margin-top:12px">Cover
                                                                                                                                Image
                                                                                                                                (PNG/JPG,
                                                                                                                                max
                                                                                                                                5MB)</label>
                                                                                                                            <input
                                                                                                                                class="input"
                                                                                                                                type="file"
                                                                                                                                id="image"
                                                                                                                                name="image"
                                                                                                                                accept="image/png,image/jpeg"
                                                                                                                                required />

                                                                                                                            <div
                                                                                                                                class="controls">
                                                                                                                                <button
                                                                                                                                    class="primary"
                                                                                                                                    type="submit">Create
                                                                                                                                    Course</button>
                                                                                                                            </div>
                                                                                                                        </form>
                                                                                                                        <% }
                                                                                                                            %>
        </main>
    </div>

    <script>
        // highlight active tab button
        const current = "<%= tab %>";
        const btnAll = document.getElementById('tab-all');
        const btnDel = document.getElementById('tab-delete');
        const btnAdd = document.getElementById('tab-add');
        if (current === 'all') btnAll?.classList.add('active');
        if (current === 'delete') btnDel?.classList.add('active');
        if (current === 'add') btnAdd?.classList.add('active');
    </script>
</body>

</html>